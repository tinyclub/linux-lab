---
title: 泰晓资讯·1 月 / 第三期 / 2022
author: 'unicornx'
group: news
draft: false
top: false
album: 泰晓资讯
layout: weekly
license: "cc-by-nc-nd-4.0"
permalink: /tinylab-weekly-1-3rd-2022/
tags:
  - Linux
  - Alibaba
  - Scheduler
  - Build
  - CleanCache
  - LLVM
categories:
  - 泰晓资讯
  - 技术动态
  - 行业动向
---

**“泰晓资讯”，广泛报道 “Linux/开源” 业界资讯。欢迎广大读者投递相关资讯来源和素材，本站将进一步收集整理后发布给大家。**

- **Linux 内核最新消息**

    <https://lkml.org/lkml/2022/1/9/294>
    
    正如我们预期的那样，Linux 5.16 内核已升级为稳定版并于本周正式发布。

    Linux 5.16 具有许多新功能，这包括：用于 Steam Play（和 Wine）的 FUTEX2 futex_waitv 系统调用，memory folios，对 AMD Ryzen 6000 mobile 系列处理器的更好支持，对 Intel Alder Lake S 显卡的更稳定的支持，对 Intel Sapphire Rapids 的 AMX 支持，对 具备 Radeon 显示改进的 AMD Ryzen 支持，以及大量其他硬件改进。

    Linus Torvalds 在 5.16 的发布公告中写道：`"Not a lot here since -rc8, which is not unexpected. We had that extra week due to the holidays, and it's not like we had lots of last-minute things that needed to be sorted out. So this mainly contains some driver fixes (mainly networking and rdma), a cgroup credential use fix, a few core networking fixes, a couple of last-minute reverts, and some other random noise."` 虽然 5.16 经历了 8 个 RC 版本，但最后的一个 RC8 也是相对比较稳定的，只是加入了一些小的 bugfix。

    简单的统计数据表明：Linux 5.16 大约有 2250 万行代码、以及额外的 380 万行注释和另外 400 万行空白行，分布在 63.5k 个文件中。总共包含大约 3040 万行的文本内容。

    现在已经进入 Linux 5.17 的合并窗口期，让我们期待更多令人兴奋的功能吧。

    <https://www.kernel.org/> updated by 2022/1/13

    |分支类型        |版本            |发布时间  |
    |----------------|----------------|----------|
    |mainline        |5.16            |2022-01-09|
    |stable          |5.15.14         |2022-01-11|
    |longterm        |5.10.91         |2022-01-11|
    |longterm        |5.4.171         |2022-01-11|
    |longterm        |4.19.225        |2022-01-11|
    |longterm        |4.14.262        |2022-01-11|
    |longterm        |4.9.297         |2022-01-11|
    |longterm        |4.4.299         |2022-01-11|
    |linux-next      |next-20220112   |2022-01-12|

    **关键词**: Linux

- **Linux 5.17 AArch64 代码已为 SME 做好准备，添加了 KCSAN 支持**

    > While the Linux 5.17 merge window hasn't opened up yet, there have been a few early pull requests sent out this week ahead of this imminent next kernel cycle. One of those already sent out is the ARM64/AArch64 CPU architecture code updates for Linux 5.17.

    将会随 Linux 5.17 合并窗口合入内核的重大改动之一是 Linux 5.17 的 ARM64/AArch64 CPU 架构代码更新。Linux 5.17 中针对 64 位 ARM 架构，有一些功能项的添加和大量代码清理。相关 PR 仅与架构有关，而不是针对新的 SoC 和其他硬件支持，该更新包括：

    - 为 ARM64 启用了 Kernel Concurrency Sanitizer (KCSAN)。 KCSAN 功能依赖 GCC 和 Clang 编译器工具实现针对 Linux 内核的 race detect。KCSAN 已经在其他架构上得到支持，而 64 位 ARM 现在也将成为支持列表的一部分。
    - 为内核实现 Scalable Matrix Extensions (SME) 所作的代码清理和准备工作。 Armv9-A 的 Scalable Matrix Extensions 基于 SVE/SVE2 构建，可提供更好、更快的矩阵运算支持。SME 允许 matrix tile storage, load/store/insert/extract tile vectors, outer products of SVE vectors, a streaming SVE mode 和其他改进。
    - 使用 SHA3 指令加速 XOR。
    - 针对更多 Arm PMU 的性能子系统更新。
    - 围绕 atomics、BTI（Branch Target Identification）和其他工作的代码清理。
    - 各种其他代码修复和改进。

    原文新闻出处，“Linux 5.17 AArch64 Code Has SME Preparations, Adds KCSAN Support” <https://www.phoronix.com/scan.php?page=news_item&px=Linux-5.17-AArch64>。

    **关键词**: Linux, AArch64

- **Linux 5.17 将支持 “第一款可用的低成本 RISC-V 平台”**

    > In addition to the prompt support for Qualcomm's Snapdragon 8 Gen 1, another exciting milestone for the in-development Linux 5.17 kernel is introducing mainline support for the StarFive JH7100, which has been trying to make its debut as the first usable and low-cost RISC-V platform.
    
    除了对 Qualcomm 的 Snapdragon 8 Gen 1 的快速支持，正在开发中的 Linux 5.17 内核的另一个激动人心的里程碑是引入了对 StarFive JH7100 的主线支持，这将是第一款可用的低成本 RISC-V 平台。

    StarFive JH7100 SoC 集成了来自 SiFive 的 U74 双核 64 位 RISC-V 处理器，运行频率为 1.5GHz，同时支持 4K 显示，但目前没有集成 3D GPU。StarFive JH7100 于去年作为一款低成本的 RISC-V SoC 发布。据报道，SiFive U74 内核的性能可以对标 Arm Cortex-A55 内核。

    让我们对 StarFive JH7100 感到更令人兴奋的是，这款来自中国的 SoC 有望出现在一些低成本的 RISC-V 开发板上。对于 Linux 5.17，除了对 JH7100 SoC 的支持外，还有计划加入 BeagleV Starlight 开发板的 DeviceTree。为内核主线加入对 JH7100 和 Starlight 开发板支持的 PR 指出，` "This SoC promises to be the first usable low-cost platform for RISC-V."`。但不幸的是，Starlight 在量产前被放弃了。我们期待有更多基于 JH7100 SoC 的开发板能够进入内核主线。

    StarFive VisionFive V1 是另一款基于此 SoC 的单板计算机。 VisionFive V1 使用带有 8GB LPDDR4 内存、microSD 卡插槽、HDMI 1.4 显示器、4 个 USB 3.0 端口的 JH7100 SoC，并且可以运行 RISC-V Linux 发行版。 VisionFive SBC 可以从中国订购，价格为 175 美元，但它被认为是实验性的，仅用于工程/开发。Antmicro 是另一家公司，他们一直在采用 JH7100 开发其开发板 Antmicro ARVSOM，该开发板兼容 Raspberry Pi Compute Module 4。
    
    很高兴看到主线内核开始支持 JH7100 这款 SoC，希望基于此产品，市面上能够尽快推出价格低于 200 美元的主板。当然，目前对于那些相对有钱的人来说，SiFive HiFive Unmatched 是不错的选择。希望在 2022 年，我们会看到更多新的更高性能的 SiFive 开发板，从而更加促进 RISC-V Linux 的开发。

    StarFive 的 GitHub 上（<https://github.com/starfive-tech/JH7100_Docs>）提供了有关 JH7100 SoC 的各种技术文档。

    原文新闻出处，“Linux 5.17 Adds Support For "The First Usable, Low-Cost RISC-V Platform"” <https://www.phoronix.com/scan.php?page=news_item&px=Linux-5.17-StarFive>。

    **关键词**: Linux, RISC-V，StarFive, JH7100

- **Linux 串口控制台驱动获得 25% 的性能改进**

    > It's not an area of Linux hardware performance we normally look at, but thanks to a Red Hat engineer discovering very low serial console performance, there is an improvement queued up for introduction in Linux 5.17...

    Linux 5.17 中有一项性能改进是有关串口控制台驱动，这个改进由来自 Red Hat 的工程师 Wander Lairson Costa 提供。他注意到 HP Proliant DL380 Gen9 服务器上的串口控制台吞吐量远低于预期：预期为 10KB/s，但当前的 Linux 内核仅达到 2.5KB/s 左右。 Linux 8250 串行控制台驱动程序仅发送一个字节就需要大约 410 微秒。

    针对 Linux 上 8250/16550 串行端口控制台驱动程序，Wander 使用 16550 UART FIFO 缓冲区，使得受影响系统上的 8250 控制台驱动程序的串行控制台吞吐量性能提高了约 25%。该补丁是本周三由 Greg Kroah-Hartman 作为 Linux 5.17 合并窗口的 TTY/serial 更新的一部分发送的。该补丁还包括了一些 TTY 代码清理等工作。还修复了一个十分古老的问题：在使用 Ctrl + Alt + Fn 键在 TTY 控制台与桌面之间切换时键盘锁定 LED 变得不一致。 

    原文新闻出处，“Linux Serial Console Driver Lands Patch For Possible ~25% Performance Improvement” <https://www.phoronix.com/scan.php?page=news_item&px=Linux-Serial-16550-FIFO>。

    **关键词**: Linux，Serial，Console

###

- **Linux 的 CleanCache 将从内核中被移除**

    > Merged into the mainline Linux kernel a decade ago was the CleanCache patch series but now it's set to be retired.

    据悉，十年前进入 Linux 内核主线的 CleanCache 将被淘汰。作为 Andrew Morton 提交的补丁的一部分，我们发现在 Linux-Next 上 CleanCache 被删除了。具体原因是因为已经没什么用户还使用它了。自 2019 年移除 Xen Transcendent Memory (TMEM) 驱动程序代码后，就再也没有看到有人使用 CleanCache 了，但 CleanCache 却还一直保留在内核中。

    CleanCache 是由 Oracle 工程师开发的，记得当初刚推出该特性时时，Oracle 对它的评价是：`"something that's actually very cool, has huge potential to make running VMs super optimized/performant/efficient and is the result of quite a bit of research and experimentation."`
    
    内核文档中对它的描述是，Cleancache 是 VFS 层提供的一项新的可选功能，它可能以可忽略不计的成本显著提高许多环境中许多工作负载的页面缓存效率。Cleancache 可以被认为是内核的页面帧替换算法（ pageframe replacement algorithm，简称 PFRA）用于以页为单位保留干净页的一个缓存，但由于没有足够的内存而无法保留。

    虽然受到 Oracle 的极力推荐，但十年后，由于缺乏实际的用户，CleanCache 还是不免被淘汰了，我们很可能在 Linux 5.17 中就再也看不到它了。
    
    更多介绍请阅读新闻出处，“Linux's CleanCache Set To Be Cleaned From The Kernel After Being Hyped Up A Decade Ago”: <https://www.phoronix.com/scan.php?page=news_item&px=Linux-Cleancache-EOL>。

    **关键词**: Linux, CleanCache
    
- **LLVM 在 2021 年实现了创纪录的增长**

    > The LLVM compiler stack saw record growth in 2021 both with the most amount of new code introduced in any single year as well as the most contributors per year this open-source project has ever seen. Even aside from the development metrics, LLVM had a pretty rocking 2021.

    LLVM 编译器在 2021 年实现了创纪录的增长，最新 GitStats 统计数据说明，这个开源编译器/工具链包含多达 111,028 个文件，以及 2385 万行代码。考虑到 Linux 内核在其更长的历史发展中，发展到目前也不过 3200 万行代码，相比起来， LLVM 的发展更加神速，这真是一项了不起的壮举。 LLVM 的代码仓库中一共有来自大约 2,903 位不同作者的 408k 次提交和贡献。

    就提交数量而言，2021 年的 LLVM 并不是最繁忙的一年，只有 32.1k 提交，而 2020 年的这一数字为 34.9k，2019 年为 33.2k......

    但在代码清理方面，LLVM 在 2021 年处于领先地位...... LLVM 增加了 1250 万行代码，删除了 830 万行，远高于 2020 年的仅添加 700 万行和删除 390 万行的情况。

    Simon Pilgrim 继续负责 2021 年的大部分提交，其次是 Fanrui Song、Roman Lebedev、Craig Topper、Nikita Popov 和 Sanjay Patel。

    2021 年 LLVM 的其他有希望的指标之一是创纪录的作者数量，提交代码的贡献者来自 1,400 个不同的电子邮件地址，高于 2020 年的 1,321 个，是到目前为止的历史最高水平。在 2020 年之前，没有一年的贡献者超过一千。现在一年有 1,400 个，这显示 LLVM 开源社区的增长相当不错。
    
    更多介绍请阅读新闻出处，“LLVM Enjoyed Record Growth In 2021, Many Exciting Compiler Advancements”: <https://www.phoronix.com/scan.php?page=news_item&px=LLVM-Record-Growth-2021>。

    **关键词**: LLVM
  
# 联系我们

资讯内容部分来自 [“LWN.net“](https://lwn.net/)。如果您对某些 LWN 文章感兴趣（譬如希望获得全文翻译的）请扫描二维码加微信联系我们：

![tinylab wechat](/images/wechat/tinylab.jpg)
